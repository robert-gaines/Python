#!/usr/bin/env python3

from queue import Queue
import threading
import socket
import time
import sys

open_ports = list()

def ScanPort(address,port):
    #
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    #
    try:
        #
        #print("[*] Scanning: %s:%s " % (address,port))
        #
        response = s.connect_ex((address,port))
        #
        if(response == 0):
            #
            open_ports.append(port)
            #
            #print("[*] Port open-> %s:%s " % (address,port))
            #
            return True
            #
        else:
            #
            return False
        #
    except:
        #
        return

def Threader(q,address):
    #
    while(True):
        #
        port = q.get()
        #
        ScanPort(address,port)
        #
        q.task_done()

def main():
    #
    q = Queue()
    #
    print("[*] Python Port Scanner [*]")
    #
    address = input("[+] Enter the target address-> ")
    #
    print("[*] Scanning...")
    #
    for i in range(1,1024):
        #
        q.put(i)
        #
    for i in range(500):
        #
        process = threading.Thread(target=Threader,args=(q,address))
        #
        process.daemon = True 
        #
        process.start()
        #
    q.join()
    #
    for p in open_ports:
        #
        print("[*] Open port-> %s:%s " % (address,p))

if(__name__ == '__main__'):
    #
    main()