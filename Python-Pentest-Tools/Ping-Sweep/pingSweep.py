#!/usr/bin/env python

from colorama import Fore
import threading
import time
import os

def parseAddress(host):
    #
    segments = host.split('.')
    #
    i = 0
    #
    networkSegment = segments[0]+'.'+segments[1]+'.'+segments[2]+'.'
    #
    return networkSegment

def Ping(host):
    #
    cmd = ''
    #
    if(os.name == 'nt'):
        #
        cmd = "ping -n 1 "
        #
    elif(os.name == 'posix'):
        #
        cmd = "ping -c 1 "
        #
    else:
        #
        cmd = "ping -c 1 "
        #
    cmdStr = cmd+host
    #
    response = os.popen(cmdStr).readlines()
    #
    if('ttl' in response[2] or 'TTL' in response[2]):
        #
        hosts.append(host)
        #
        return
        #
    else:
        #
        return
            
def main():
    #
    print(Fore.LIGHTGREEN_EX+"""
*********************************
*  ____  _                      * 
* |  _ \(_)_ __   __ _          * 
* | |_) | | '_ \ / _` |         * 
* |  __/| | | | | (_| |         * 
* |_|__ |_|_| |_|\__, |         * 
* / ___|_      __|___/___ _ __  * 
* \___ \ \ /\ / / _ \/ _ \ '_ \ *
*  ___) \ V  V /  __/  __/ |_) |*
* |____/ \_/\_/ \___|\___| .__/ *
*                        |_|    *
*********************************
          """)
    #
    host = input("[+] Enter the network address-> ")
    #
    print("[*] Entered: %s " % host)
    #
    network = parseAddress(host)
    #
    threads = []
    #
    print(Fore.MAGENTA+"[*] Initiating Sweep [*]")
    #
    start = time.time()
    #
    for i in range(256):
        #
        host = network+str(i)
        #
        t = threading.Thread(target=Ping, args=(host,))
        #
        threads.append(t)
        #
        t.start()
        #
    for j in threads:
        #
        j.join()
    #
    titleString = (
    """
    ************************************
    *          Sweep Results           *
    ************************************
    """ )
    #
    fileObject = open("active_hosts.txt",'w')
    #
    fileObject.write(titleString+'\n')
    #
    for h in hosts:
        #
        print(Fore.LIGHTGREEN_EX+"[*] Host alive on:    %s [*]" % h)
        #
        activeString = "[*] Host alive on:    %s [*]\n" % h
        #
        fileObject.write(activeString)
    #
    end = time.time()
    #
    netTime = (end-start)
    #
    print("[*] Total time required (seconds): %i " % netTime)
    #
    fileObject.close()

if(__name__ == '__main__'):
    #
    hosts = []
    #
    main()
