#!/usr/bin/env python3

from scapy.all import *
import subprocess
import time

'''
-> Identify clients on the network via ARP Broadcast
'''

def ScanNetwork(net):
    #
    ARPRequest = ARP(pdst=net)
    #
    Broadcast = Ether(dst="ff:ff:ff:ff:ff:ff")
    #
    ARPBroadcast = Broadcast/ARPRequest
    #
    ans = srp(ARPBroadcast,timeout=1,verbose=False)[0]
    #
    print("Host\t\t\t MAC Address")
    #
    print("-----------\t\t -----------------")
    #
    for entity in ans:
        #
        print(entity[1].psrc,"\t\t",entity[1].hwsrc)

def main():
    #
    print("[*] Network ARP Scaner [*]")
    #
    print()
    #
    network = input("[+] Enter the network address in CIDR notation-> ")
    #
    print()
    #
    print("[*] Scanning %s ..." % network)
    #
    print()
    #
    time.sleep(1)
    #
    while(True):
        #
        ScanNetwork(network)
        #
        time.sleep(3)
        #
        subprocess.call('clear',shell=True)

if(__name__ == '__main__'):
    #
    main()
